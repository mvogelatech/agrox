# Seeders and Migration

### Seeders
This folder contains must be used to place scripts to add default data to the database.

>I.e.: data that are used as configuration information or as default values used >by the application.
>Examples: role identification for users, color definitions for plagues, the >initial terms and coditions, etc.

In order to create a new Seed revision (if new data needs to be added always create a new Seed revision) follow the steps bellow:
- Create a folder under seeders/default/ using the next number for the sequence: i.e: if the greatest number is seeders/default/09 , then create a folder as seeders/default/10
- Place a copy of the script seeding_control_script.sql inside this newly created folder.
- Place any necessary scripts to add data to the database , if the order of the scripts matter (inside the folder) use a prefix on each script like: 01_script_that_must_run_first.sql, 02_script_that_follows.sql.
- Remember to run **PRISMA migration SAVE** command if changes were made to the database structure (DDL).

### Migration

> Basic instructions can be found here:
 https://www.prisma.io/docs/reference/tools-and-interfaces/prisma-cli/command-reference#migrations-experimental

If any changes are were made to the database structure you must run prisma migration tool to generate a migration tag to be used to update the prod/dev/local databases. Here follows the workflow to be used:

1. After changing the database structure (using pgmodeler) apply the changes to your local database then run the prisma instrospect command to update the schema:
```sh
$ cd backend/agrox-api/ && npx prisma introspect && npx prisma generate
```
2. Then create a migration tag for your change
```sh
$ yarn prisma migrate dev --preview-feature
```
>The script will ask for a name , give something meaningfull but do not worry the name will be used internally by prisma.
3. Commit the files generated by the prisma command, these files are under backend/agrox-api/prisma/migrations.
