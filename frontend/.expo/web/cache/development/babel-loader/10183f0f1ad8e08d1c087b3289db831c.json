{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nvar _jsxFileName = \"/home/jmgoncalves/git/agro-x/frontend/components/02-general/bottom-cards/diagnosis-field-profile/infestation-report/prescription.tsx\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React from 'react';\nimport Linking from \"react-native-web/dist/exports/Linking\";\nimport View from \"react-native-web/dist/exports/View\";\nimport { createTStyleSheet } from \"../../../../../src/utils/style\";\nimport { useMainSelector } from \"../../../../../redux-things\";\nimport { getLatestDiagnosis, getPrescriptionStatus } from \"../../../../../src/utils\";\nimport { Message } from \"../../../../00-common/message\";\nimport { prescriptionNotInfested, prescriptionNotAvailable, displayAlert } from \"../../../../../src/utils/alert-messages\";\nimport { PrescriptionTable } from \"../../../../00-common/prescription-table\";\nimport { formatWhatsAppURL, WHATSAPP_DEFAULT_NUMBER } from \"../../../../drawer-constants\";\nexport function Prescription() {\n  var field = useMainSelector(function (state) {\n    return state.interactionData.general.currentField;\n  });\n  var farmName = useMainSelector(function (state) {\n    var _state$backendData$us;\n\n    return (_state$backendData$us = state.backendData.user) == null ? void 0 : _state$backendData$us.many_user_has_many_farm[0].farm.fantasy_name;\n  });\n  var latestDiagnosis = getLatestDiagnosis(field);\n  var prescription = latestDiagnosis.prescription[0];\n  var status = getPrescriptionStatus(latestDiagnosis);\n  if (status === 'not-infested') return React.createElement(Message, _extends({}, prescriptionNotInfested, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 19,\n      columnNumber: 40\n    }\n  }));\n  if (status === 'not-available') return React.createElement(Message, _extends({}, prescriptionNotAvailable, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 41\n    }\n  }));\n\n  function whatsAppButtonPress() {\n    var msg, ret;\n    return _regeneratorRuntime.async(function whatsAppButtonPress$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (!(prescription.author && prescription.phone_number)) {\n              _context.next = 13;\n              break;\n            }\n\n            msg = \"Ol\\xE1 \" + prescription.author + \" estou precisando de uma ajuda referente ao receitu\\xE1rio emitido pelo Sr. para o \" + field.name + \" da fazenda \" + farmName;\n            _context.prev = 2;\n            _context.next = 5;\n            return _regeneratorRuntime.awrap(Linking.openURL(formatWhatsAppURL(msg, prescription.phone_number)));\n\n          case 5:\n            ret = _context.sent;\n            return _context.abrupt(\"return\", ret);\n\n          case 9:\n            _context.prev = 9;\n            _context.t0 = _context[\"catch\"](2);\n            displayAlert({\n              title: \"Informa\\xE7\\xE3o\",\n              body: \"N\\xE3o foi poss\\xEDvel abrir o WhatsApp, favor entrar em contato pelo telefone: \" + WHATSAPP_DEFAULT_NUMBER,\n              buttonText: 'Ok'\n            });\n            return _context.abrupt(\"return\", _context.t0.message);\n\n          case 13:\n            displayAlert({\n              title: \"Informa\\xE7\\xE3o\",\n              body: \"N\\xE3o h\\xE1 um contato associado a este receitu\\xE1rio, favor solicitar ajuda usando o bot\\xE3o de 'Ajuda' no menu principal do aplicativo.\",\n              buttonText: 'Ok'\n            });\n\n          case 14:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[2, 9]], Promise);\n  }\n\n  return React.createElement(View, {\n    style: styles.mainView,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 3\n    }\n  }, React.createElement(PrescriptionTable, {\n    mode: \"card\",\n    prescription: prescription,\n    onWhatsAppButtonPress: whatsAppButtonPress,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 4\n    }\n  }));\n}\nvar styles = createTStyleSheet({\n  mainView: {\n    flexDirection: 'column',\n    marginHorizontal: '16rem',\n    marginVertical: '16rem',\n    backgroundColor: 'white'\n  }\n});","map":{"version":3,"sources":["/home/jmgoncalves/git/agro-x/frontend/components/02-general/bottom-cards/diagnosis-field-profile/infestation-report/prescription.tsx"],"names":["React","createTStyleSheet","useMainSelector","getLatestDiagnosis","getPrescriptionStatus","Message","prescriptionNotInfested","prescriptionNotAvailable","displayAlert","PrescriptionTable","formatWhatsAppURL","WHATSAPP_DEFAULT_NUMBER","Prescription","field","state","interactionData","general","currentField","farmName","backendData","user","many_user_has_many_farm","farm","fantasy_name","latestDiagnosis","prescription","status","whatsAppButtonPress","author","phone_number","msg","name","Linking","openURL","ret","title","body","buttonText","message","styles","mainView","flexDirection","marginHorizontal","marginVertical","backgroundColor"],"mappings":";;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;;;AAEA,SAASC,iBAAT;AAEA,SAASC,eAAT;AACA,SAASC,kBAAT,EAA6BC,qBAA7B;AACA,SAASC,OAAT;AACA,SAASC,uBAAT,EAAkCC,wBAAlC,EAA4DC,YAA5D;AACA,SAASC,iBAAT;AACA,SAASC,iBAAT,EAA4BC,uBAA5B;AAEA,OAAO,SAASC,YAAT,GAAwB;AAC9B,MAAMC,KAAK,GAAGX,eAAe,CAAC,UAACY,KAAD;AAAA,WAAWA,KAAK,CAACC,eAAN,CAAsBC,OAAtB,CAA8BC,YAAzC;AAAA,GAAD,CAA7B;AACA,MAAMC,QAAQ,GAAGhB,eAAe,CAAC,UAACY,KAAD;AAAA;;AAAA,oCAAWA,KAAK,CAACK,WAAN,CAAkBC,IAA7B,qBAAW,sBAAwBC,uBAAxB,CAAgD,CAAhD,EAAmDC,IAAnD,CAAwDC,YAAnE;AAAA,GAAD,CAAhC;AACA,MAAMC,eAAe,GAAGrB,kBAAkB,CAACU,KAAD,CAA1C;AACA,MAAMY,YAAY,GAAGD,eAAe,CAACC,YAAhB,CAA6B,CAA7B,CAArB;AAEA,MAAMC,MAAM,GAAGtB,qBAAqB,CAACoB,eAAD,CAApC;AACA,MAAIE,MAAM,KAAK,cAAf,EAA+B,OAAO,oBAAC,OAAD,eAAapB,uBAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAP;AAC/B,MAAIoB,MAAM,KAAK,eAAf,EAAgC,OAAO,oBAAC,OAAD,eAAanB,wBAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAP;;AAEhC,WAAeoB,mBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACKF,YAAY,CAACG,MAAb,IAAuBH,YAAY,CAACI,YADzC;AAAA;AAAA;AAAA;;AAEQC,YAAAA,GAFR,eAEqBL,YAAY,CAACG,MAFlC,2FAE2Hf,KAAK,CAACkB,IAFjI,oBAEoJb,QAFpJ;AAAA;AAAA;AAAA,6CAIqBc,OAAO,CAACC,OAAR,CAAgBvB,iBAAiB,CAACoB,GAAD,EAAML,YAAY,CAACI,YAAnB,CAAjC,CAJrB;;AAAA;AAISK,YAAAA,GAJT;AAAA,6CAKUA,GALV;;AAAA;AAAA;AAAA;AAOG1B,YAAAA,YAAY,CAAC;AACZ2B,cAAAA,KAAK,oBADO;AAEZC,cAAAA,IAAI,uFAA+EzB,uBAFvE;AAGZ0B,cAAAA,UAAU,EAAE;AAHA,aAAD,CAAZ;AAPH,6CAYU,YAAMC,OAZhB;;AAAA;AAgBC9B,YAAAA,YAAY,CAAC;AACZ2B,cAAAA,KAAK,oBADO;AAEZC,cAAAA,IAAI,gJAFQ;AAGZC,cAAAA,UAAU,EAAE;AAHA,aAAD,CAAZ;;AAhBD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAuBA,SACC,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAEE,MAAM,CAACC,QAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACC,oBAAC,iBAAD;AAAmB,IAAA,IAAI,EAAC,MAAxB;AAA+B,IAAA,YAAY,EAAEf,YAA7C;AAA2D,IAAA,qBAAqB,EAAEE,mBAAlF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADD,CADD;AAKA;AAED,IAAMY,MAAM,GAAGtC,iBAAiB,CAAC;AAChCuC,EAAAA,QAAQ,EAAE;AACTC,IAAAA,aAAa,EAAE,QADN;AAETC,IAAAA,gBAAgB,EAAE,OAFT;AAGTC,IAAAA,cAAc,EAAE,OAHP;AAITC,IAAAA,eAAe,EAAE;AAJR;AADsB,CAAD,CAAhC","sourcesContent":["import React from 'react';\nimport { Linking, View } from 'react-native';\nimport { createTStyleSheet } from '../../../../../src/utils/style';\n\nimport { useMainSelector } from '../../../../../redux-things';\nimport { getLatestDiagnosis, getPrescriptionStatus } from '../../../../../src/utils';\nimport { Message } from '../../../../00-common/message';\nimport { prescriptionNotInfested, prescriptionNotAvailable, displayAlert } from '../../../../../src/utils/alert-messages';\nimport { PrescriptionTable } from '../../../../00-common/prescription-table';\nimport { formatWhatsAppURL, WHATSAPP_DEFAULT_NUMBER } from '../../../../drawer-constants';\n\nexport function Prescription() {\n\tconst field = useMainSelector((state) => state.interactionData.general.currentField)!;\n\tconst farmName = useMainSelector((state) => state.backendData.user?.many_user_has_many_farm[0].farm.fantasy_name)!;\n\tconst latestDiagnosis = getLatestDiagnosis(field)!;\n\tconst prescription = latestDiagnosis.prescription[0];\n\n\tconst status = getPrescriptionStatus(latestDiagnosis);\n\tif (status === 'not-infested') return <Message {...prescriptionNotInfested} />;\n\tif (status === 'not-available') return <Message {...prescriptionNotAvailable} />;\n\n\tasync function whatsAppButtonPress() {\n\t\tif (prescription.author && prescription.phone_number) {\n\t\t\tconst msg = `Olá ${prescription.author} estou precisando de uma ajuda referente ao receituário emitido pelo Sr. para o ${field.name} da fazenda ${farmName}`;\n\t\t\ttry {\n\t\t\t\tconst ret = await Linking.openURL(formatWhatsAppURL(msg, prescription.phone_number));\n\t\t\t\treturn ret;\n\t\t\t} catch (error) {\n\t\t\t\tdisplayAlert({\n\t\t\t\t\ttitle: `Informação`,\n\t\t\t\t\tbody: `Não foi possível abrir o WhatsApp, favor entrar em contato pelo telefone: ${WHATSAPP_DEFAULT_NUMBER}`,\n\t\t\t\t\tbuttonText: 'Ok',\n\t\t\t\t});\n\t\t\t\treturn error.message;\n\t\t\t}\n\t\t}\n\n\t\tdisplayAlert({\n\t\t\ttitle: `Informação`,\n\t\t\tbody: `Não há um contato associado a este receituário, favor solicitar ajuda usando o botão de 'Ajuda' no menu principal do aplicativo.`,\n\t\t\tbuttonText: 'Ok',\n\t\t});\n\t}\n\n\treturn (\n\t\t<View style={styles.mainView}>\n\t\t\t<PrescriptionTable mode=\"card\" prescription={prescription} onWhatsAppButtonPress={whatsAppButtonPress} />\n\t\t</View>\n\t);\n}\n\nconst styles = createTStyleSheet({\n\tmainView: {\n\t\tflexDirection: 'column',\n\t\tmarginHorizontal: '16rem',\n\t\tmarginVertical: '16rem',\n\t\tbackgroundColor: 'white',\n\t},\n});\n"]},"metadata":{},"sourceType":"module"}